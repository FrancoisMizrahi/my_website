---
title: 'MAM 2022 Pre-programme Assignment'
author: "FRANCOIS MIZRAHI"
date: "24/08/2021"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    toc: yes
    toc_float: yes
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="francois-biography" class="section level1">
<h1>Francois’ Biography</h1>
<p><img src="https://media-exp1.licdn.com/dms/image/C4E03AQFwPoeBWWouKg/profile-displayphoto-shrink_400_400/0/1599078939714?e=1635379200&amp;v=beta&amp;t=fjucSNn5CH_RpgK7QDllgpxDeB2RdtoaykivcAcKsTQ" /></p>
<div id="education" class="section level2">
<h2>Education</h2>
<p>I’m <strong>Francois</strong>. As you will probably guess from my accent, I’m <strong>french</strong> from Paris. I grew up with <strong>seven siblings</strong>, and all of my older brothers and sisters were in engineering. So quite early on, I really wanted to forge my own path, so I decided to go study <em>business and management</em> in the UK.</p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>During my time as a <strong>product manager</strong> at <a href="https://www.credit.fr/">Credit.fr</a>, I saw first hand how central data has become in decision making especially in the <em>Fintech</em> industry. And I found it fascinating how technology, data and the digital transformation has reshaped modern management. It really made me understand how critical it is for me to learn how to leverage:</p>
<ul>
<li>Business knowledge</li>
<li>Technical skills</li>
</ul>
</div>
<div id="why-lbs" class="section level2">
<h2>Why LBS</h2>
<p>My experience as a <strong>data engineer</strong> at <a href="https://www.papernest.com/">Papernest</a> gave me many of the technical tools needed to manipulate data efficiently but I am still missing some of the analytics and management skills I need to use these tools in practical business situations.
And so the Master in Analytics and Management at LBS is the perfect opportunity for me to combine advanced technical education with modern management skills before taking a product manager role in the Fintech industry.</p>
</div>
<div id="interests" class="section level2">
<h2>Interests</h2>
<p>I am also passionate about:</p>
<ol style="list-style-type: decimal">
<li><em>Photography</em></li>
<li><em>Photo Editing</em></li>
<li><em>Art</em></li>
</ol>
</div>
</div>
<div id="gapminder-country-comparison" class="section level1">
<h1>Gapminder country comparison</h1>
<p>The <code>gapminder</code> dataset has data on life expectancy, population, and GDP per capita for 142 countries from 1952 to 2007.</p>
<pre class="r"><code>head(gapminder, 20)</code></pre>
<pre><code>## # A tibble: 20 × 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## 11 Afghanistan Asia       2002    42.1 25268405      727.
## 12 Afghanistan Asia       2007    43.8 31889923      975.
## 13 Albania     Europe     1952    55.2  1282697     1601.
## 14 Albania     Europe     1957    59.3  1476505     1942.
## 15 Albania     Europe     1962    64.8  1728137     2313.
## 16 Albania     Europe     1967    66.2  1984060     2760.
## 17 Albania     Europe     1972    67.7  2263554     3313.
## 18 Albania     Europe     1977    68.9  2509048     3533.
## 19 Albania     Europe     1982    70.4  2780097     3631.
## 20 Albania     Europe     1987    72    3075321     3739.</code></pre>
<pre class="r"><code>country_data &lt;- gapminder %&gt;%
            filter(country == &quot;France&quot;)

continent_data &lt;- gapminder %&gt;%
            filter(continent == &quot;Europe&quot;)</code></pre>
<p>Let’s look at <strong>France’s</strong> life expectancy over time.</p>
<pre class="r"><code>plot1 &lt;- ggplot(data = country_data, mapping = aes(x = year, y = lifeExp))+
   geom_point() +
   geom_smooth(se = FALSE)+
   NULL</code></pre>
<pre class="r"><code>plot1&lt;- plot1 +
  labs(title = &quot;France&#39;s life expectency over the years&quot;,
      x = &quot;Year&quot;,
      y = &quot;Life Expectancy&quot;) +
  NULL

plot1</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/lifeExp_one_country_with_label-1.png" width="672" /></p>
<p>Now we can look at life expectancy in all countries in <strong>Europe</strong>.</p>
<pre class="r"><code>ggplot(continent_data, mapping = aes(x = year, y = lifeExp  , colour=country, group=country))+
  geom_point() +
  geom_smooth(se = FALSE) +
  NULL</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/lifeExp_one_continent-1.png" width="672" /></p>
<p>Let’s look at the trend in the other <strong>continents</strong></p>
<pre class="r"><code>ggplot(data = gapminder , mapping = aes(x = year, y = lifeExp , colour= continent))+
  geom_point() +
  geom_smooth(se = FALSE) +
  facet_wrap(~continent) +
  theme(legend.position=&quot;none&quot;) +
  NULL</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/lifeExp_facet_by_continent-1.png" width="672" /></p>
<blockquote>
<p>The evolution of life expectancy since 1952 is a story of inequalities. Even if all continents have general upward trends, significant gaps still exist, even within the same continents. In Africa, an almost 40 years difference separates more developed countries from less developed ones, and the gap is still growing. Development seems to be the primary indicator of a continent’s life expectancy as Europe and Oceania have the highest average life expectancy.</p>
</blockquote>
</div>
<div id="brexit-vote-analysis" class="section level1">
<h1>Brexit vote analysis</h1>
<p>We will have a look at the results of the 2016 Brexit vote in the UK.</p>
<pre class="r"><code>brexit_results &lt;- read_csv(here::here(&quot;data&quot;,&quot;brexit_results.csv&quot;))

glimpse(brexit_results)</code></pre>
<pre><code>## Rows: 632
## Columns: 11
## $ Seat        &lt;chr&gt; &quot;Aldershot&quot;, &quot;Aldridge-Brownhills&quot;, &quot;Altrincham and Sale W…
## $ con_2015    &lt;dbl&gt; 50.592, 52.050, 52.994, 43.979, 60.788, 22.418, 52.454, 22…
## $ lab_2015    &lt;dbl&gt; 18.333, 22.369, 26.686, 34.781, 11.197, 41.022, 18.441, 49…
## $ ld_2015     &lt;dbl&gt; 8.824, 3.367, 8.383, 2.975, 7.192, 14.828, 5.984, 2.423, 1…
## $ ukip_2015   &lt;dbl&gt; 17.867, 19.624, 8.011, 15.887, 14.438, 21.409, 18.821, 21.…
## $ leave_share &lt;dbl&gt; 57.89777, 67.79635, 38.58780, 65.29912, 49.70111, 70.47289…
## $ born_in_uk  &lt;dbl&gt; 83.10464, 96.12207, 90.48566, 97.30437, 93.33793, 96.96214…
## $ male        &lt;dbl&gt; 49.89896, 48.92951, 48.90621, 49.21657, 48.00189, 49.17185…
## $ unemployed  &lt;dbl&gt; 3.637000, 4.553607, 3.039963, 4.261173, 2.468100, 4.742731…
## $ degree      &lt;dbl&gt; 13.870661, 9.974114, 28.600135, 9.336294, 18.775591, 6.085…
## $ age_18to24  &lt;dbl&gt; 9.406093, 7.325850, 6.437453, 7.747801, 5.734730, 8.209863…</code></pre>
<p>The data comes from <a href="https://www.thecrosstab.com/">Elliott Morris</a>, who cleaned it and made it available through his <a href="https://www.datacamp.com/courses/analyzing-election-and-polling-data-in-r">DataCamp class on analysing election and polling data in R</a>.</p>
<p>Our main outcome variable (or y) is <code>leave_share</code>, which is the percent of votes cast in favour of Brexit, or leaving the EU. Each row is a UK <a href="https://en.wikipedia.org/wiki/United_Kingdom_Parliament_constituencies">parliament constituency</a>.</p>
<p>To get a sense of the spread, or distribution, of the data, we plot a histogram, a density plot, and the empirical cumulative distribution function of the leave % in all constituencies.</p>
<pre class="r"><code># histogram
ggplot(brexit_results, aes(x = leave_share)) +
  geom_histogram(binwidth = 2.5, color=&quot;black&quot;, fill=&quot;lightblue&quot;, aes(y=..density..)) +
  geom_density(alpha=.1, fill=&quot;#FF6666&quot;) +
  labs(title = &quot;Histogram of leave share across UK parliament constituencies&quot;,
       x = &quot;Percent of votes cast in favour of leaving the EU&quot;,
       y = &quot;Number of UK parliament constituencies&quot;)</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/brexit_histogram-1.png" width="672" /></p>
<pre class="r"><code># density plot-- think smoothed histogram
ggplot(brexit_results, aes(x = leave_share)) +
  geom_density() +
  labs(title = &quot;Density of leave share across UK parliament constituencies&quot;,
       x = &quot;Percent of votes cast in favour of leaving the EU&quot;,
       y = &quot;Density&quot;)</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/brexit_histogram-2.png" width="672" /></p>
<pre class="r"><code># The empirical cumulative distribution function (ECDF)
ggplot(brexit_results, aes(x = leave_share)) +
  stat_ecdf(geom = &quot;step&quot;, pad = FALSE) +
  scale_y_continuous(labels = scales::percent) +
  labs(title = &quot;Empirical cumulative distribution of leave share across UK parliament constituencies&quot;,
       x = &quot;Percent of votes cast in favour of leaving the EU&quot;,
       y = &quot;Cumulative Percentage of the population&quot;)</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/brexit_histogram-3.png" width="672" /></p>
<p>One common explanation for the Brexit outcome was fear of immigration and opposition to the EU’s more open border policy. We check the relationship (or correlation) between the proportion of native born residents in a constituency and its <code>leave_share</code>. To do this, let us get the correlation between the two variables</p>
<pre class="r"><code>brexit_results %&gt;%
  select(leave_share, born_in_uk) %&gt;%
  cor()</code></pre>
<pre><code>##             leave_share born_in_uk
## leave_share   1.0000000  0.4934295
## born_in_uk    0.4934295  1.0000000</code></pre>
<p>The correlation is almost 0.5, which shows that the two variables are positively correlated.</p>
<p>We can also create a scatterplot between these two variables.</p>
<pre class="r"><code>ggplot(brexit_results, aes(x = born_in_uk, y = leave_share, size= age_18to24)) +
  geom_point(alpha=0.3) +

  # add a smoothing line, and use method=&quot;lm&quot; to get the best straight-line
  geom_smooth(method = &quot;lm&quot;) +

  # use a white background and frame the plot with a black box
  theme_bw() +
  
  labs(title = &quot;How the place of birth affected the vote&quot;,
       x = &quot;Percent of votes cast in favour of leaving the EU&quot;,
       y = &quot;Percent of people born in the UK&quot;,
       size= &quot;Percent of people between 18 and 24&quot;) +
  NULL</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/brexit_immigration_plot-1.png" width="672" /></p>
<pre class="r"><code>ggplot(brexit_results, aes(x = age_18to24, y = leave_share)) +
  geom_point(alpha=0.3) +

  # add a smoothing line, and use method=&quot;lm&quot; to get the best straight-line
  geom_smooth(method = &quot;lm&quot;) +

  # use a white background and frame the plot with a black box
  theme_bw() +
  labs(title = &quot;How age affected the vote&quot;,
       x = &quot;Percent of people between 18 and 24&quot;,
       y = &quot;Percent of votes cast in favour of leaving the EU&quot;) +
  NULL</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/brexit_immigration_plot_age-1.png" width="672" /></p>
<blockquote>
<p>From our analysis, it is clear that a strong relationship exists between the place of birth and the desire to leave the EU. This could be explained by a strong attachment to their home country and a fear of seeing some significant changes due to immigration. Also, it is interesting to note that this relationship can be extended to the age of the population. We could speculate that the evolution of education has shifted the mind of younger generations toward staying in the EU.</p>
</blockquote>
</div>
<div id="animal-rescue-incidents-attended-by-the-london-fire-brigade" class="section level1">
<h1>Animal rescue incidents attended by the London Fire Brigade</h1>
<p><a href="https://data.london.gov.uk/dataset/animal-rescue-incidents-attended-by-lfb">The London Fire Brigade</a> attends a range of non-fire incidents (which we call ‘special services’). These ‘special services’ include assistance to animals that may be trapped or in distress. The data is provided from January 2009 and is updated monthly. A range of information is supplied for each incident including some location information (postcode, borough, ward), as well as the data/time of the incidents. We do not routinely record data about animal deaths or injuries.</p>
<p>Please note that any cost included is a notional cost calculated based on the length of time rounded up to the nearest hour spent by Pump, Aerial and FRU appliances at the incident and charged at the current Brigade hourly rate.</p>
<pre class="r"><code>url &lt;- &quot;https://data.london.gov.uk/download/animal-rescue-incidents-attended-by-lfb/8a7d91c2-9aec-4bde-937a-3998f4717cd8/Animal%20Rescue%20incidents%20attended%20by%20LFB%20from%20Jan%202009.csv&quot;

animal_rescue &lt;- read_csv(url,
                          locale = locale(encoding = &quot;CP1252&quot;)) %&gt;%
  janitor::clean_names()


glimpse(animal_rescue)</code></pre>
<pre><code>## Rows: 7,772
## Columns: 31
## $ incident_number               &lt;chr&gt; &quot;139091&quot;, &quot;275091&quot;, &quot;2075091&quot;, &quot;2872091&quot;…
## $ date_time_of_call             &lt;chr&gt; &quot;01/01/2009 03:01&quot;, &quot;01/01/2009 08:51&quot;, …
## $ cal_year                      &lt;dbl&gt; 2009, 2009, 2009, 2009, 2009, 2009, 2009…
## $ fin_year                      &lt;chr&gt; &quot;2008/09&quot;, &quot;2008/09&quot;, &quot;2008/09&quot;, &quot;2008/0…
## $ type_of_incident              &lt;chr&gt; &quot;Special Service&quot;, &quot;Special Service&quot;, &quot;S…
## $ pump_count                    &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, …
## $ pump_hours_total              &lt;chr&gt; &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, …
## $ hourly_notional_cost          &lt;dbl&gt; 255, 255, 255, 255, 255, 255, 255, 255, …
## $ incident_notional_cost        &lt;chr&gt; &quot;510&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;…
## $ final_description             &lt;chr&gt; &quot;Redacted&quot;, &quot;Redacted&quot;, &quot;Redacted&quot;, &quot;Red…
## $ animal_group_parent           &lt;chr&gt; &quot;Dog&quot;, &quot;Fox&quot;, &quot;Dog&quot;, &quot;Horse&quot;, &quot;Rabbit&quot;, …
## $ originof_call                 &lt;chr&gt; &quot;Person (land line)&quot;, &quot;Person (land line…
## $ property_type                 &lt;chr&gt; &quot;House - single occupancy&quot;, &quot;Railings&quot;, …
## $ property_category             &lt;chr&gt; &quot;Dwelling&quot;, &quot;Outdoor Structure&quot;, &quot;Outdoo…
## $ special_service_type_category &lt;chr&gt; &quot;Other animal assistance&quot;, &quot;Other animal…
## $ special_service_type          &lt;chr&gt; &quot;Animal assistance involving livestock -…
## $ ward_code                     &lt;chr&gt; &quot;E05011467&quot;, &quot;E05000169&quot;, &quot;E05000558&quot;, &quot;…
## $ ward                          &lt;chr&gt; &quot;Crystal Palace &amp; Upper Norwood&quot;, &quot;Woods…
## $ borough_code                  &lt;chr&gt; &quot;E09000008&quot;, &quot;E09000008&quot;, &quot;E09000029&quot;, &quot;…
## $ borough                       &lt;chr&gt; &quot;Croydon&quot;, &quot;Croydon&quot;, &quot;Sutton&quot;, &quot;Hilling…
## $ stn_ground_name               &lt;chr&gt; &quot;Norbury&quot;, &quot;Woodside&quot;, &quot;Wallington&quot;, &quot;Ru…
## $ uprn                          &lt;chr&gt; &quot;NULL&quot;, &quot;NULL&quot;, &quot;NULL&quot;, &quot;100021491149&quot;, …
## $ street                        &lt;chr&gt; &quot;Waddington Way&quot;, &quot;Grasmere Road&quot;, &quot;Mill…
## $ usrn                          &lt;chr&gt; &quot;20500146&quot;, &quot;NULL&quot;, &quot;NULL&quot;, &quot;21401484&quot;, …
## $ postcode_district             &lt;chr&gt; &quot;SE19&quot;, &quot;SE25&quot;, &quot;SM5&quot;, &quot;UB9&quot;, &quot;RM3&quot;, &quot;RM…
## $ easting_m                     &lt;chr&gt; &quot;NULL&quot;, &quot;534785&quot;, &quot;528041&quot;, &quot;504689&quot;, &quot;N…
## $ northing_m                    &lt;chr&gt; &quot;NULL&quot;, &quot;167546&quot;, &quot;164923&quot;, &quot;190685&quot;, &quot;N…
## $ easting_rounded               &lt;dbl&gt; 532350, 534750, 528050, 504650, 554650, …
## $ northing_rounded              &lt;dbl&gt; 170050, 167550, 164950, 190650, 192350, …
## $ latitude                      &lt;chr&gt; &quot;NULL&quot;, &quot;51.39095371&quot;, &quot;51.36894086&quot;, &quot;5…
## $ longitude                     &lt;chr&gt; &quot;NULL&quot;, &quot;-0.064166887&quot;, &quot;-0.161985191&quot;, …</code></pre>
<p>One of the more useful things one can do with any data set is quick counts, namely to see how many observations fall within one category.</p>
<pre class="r"><code>animal_rescue %&gt;%
  count(cal_year, name=&quot;count&quot;)</code></pre>
<pre><code>## # A tibble: 13 × 2
##    cal_year count
##       &lt;dbl&gt; &lt;int&gt;
##  1     2009   568
##  2     2010   611
##  3     2011   620
##  4     2012   603
##  5     2013   585
##  6     2014   583
##  7     2015   540
##  8     2016   604
##  9     2017   539
## 10     2018   610
## 11     2019   604
## 12     2020   758
## 13     2021   547</code></pre>
<p>Let us try to see how many incidents we have by animal group.</p>
<pre class="r"><code>animal_rescue %&gt;%

  #count does the same thing as group_by and summarise
  # name = &quot;count&quot; will call the column with the counts &quot;count&quot; ( exciting, I know)
  # and &#39;sort=TRUE&#39; will sort them from max to min
  count(animal_group_parent, name=&quot;count&quot;, sort=TRUE) %&gt;%
  mutate(percent = round(100*count/sum(count),2))</code></pre>
<pre><code>## # A tibble: 28 × 3
##    animal_group_parent              count percent
##    &lt;chr&gt;                            &lt;int&gt;   &lt;dbl&gt;
##  1 Cat                               3736   48.1 
##  2 Bird                              1611   20.7 
##  3 Dog                               1213   15.6 
##  4 Fox                                366    4.71
##  5 Unknown - Domestic Animal Or Pet   199    2.56
##  6 Horse                              195    2.51
##  7 Deer                               132    1.7 
##  8 Unknown - Wild Animal               93    1.2 
##  9 Squirrel                            66    0.85
## 10 Unknown - Heavy Livestock Animal    50    0.64
## # … with 18 more rows</code></pre>
<p>Finally, let us have a loot at the notional cost for rescuing each of these animals. As the LFB says,</p>
<blockquote>
<p>Please note that any cost included is a notional cost calculated based on the length of time rounded up to the nearest hour spent by Pump, Aerial and FRU appliances at the incident and charged at the current Brigade hourly rate.</p>
</blockquote>
<p>we need to fix <code>incident_notional_cost</code> as it is stored as a <code>chr</code>, or character, rather than a number.</p>
<pre class="r"><code># readr::parse_number() will convert any numerical values stored as characters into numbers
animal_rescue &lt;- animal_rescue %&gt;%

  # we use mutate() to use the parse_number() function and overwrite the same variable
  mutate(incident_notional_cost = parse_number(incident_notional_cost))</code></pre>
<p>Now tht incident_notional_cost is numeric, let us quickly calculate summary statistics for each animal group.</p>
<pre class="r"><code>gouped_animal_rescue &lt;- animal_rescue %&gt;%

  # group by animal_group_parent
  group_by(animal_group_parent) %&gt;%

  # filter resulting data, so each group has at least 6 observations
  filter(n()&gt;6) %&gt;%

  # summarise() will collapse all values into 3 values: the mean, median, and count
  # we use na.rm=TRUE to make sure we remove any NAs, or cases where we do not have the incident cos
  summarise(mean_incident_cost = mean (incident_notional_cost, na.rm=TRUE),
            median_incident_cost = median (incident_notional_cost, na.rm=TRUE),
            sd_incident_cost = sd (incident_notional_cost, na.rm=TRUE),
            min_incident_cost = min (incident_notional_cost, na.rm=TRUE),
            max_incident_cost = max (incident_notional_cost, na.rm=TRUE),
            count = n()) %&gt;%

  # sort the resulting data in descending order. You choose whether to sort by count or mean cost.
  arrange(-mean_incident_cost)
gouped_animal_rescue</code></pre>
<pre><code>## # A tibble: 16 × 7
##    animal_group_parent      mean_incident_co… median_incident_… sd_incident_cost
##    &lt;chr&gt;                                &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
##  1 Horse                                 740.               596            541. 
##  2 Cow                                   634.               520            475. 
##  3 Deer                                  417.               333            286. 
##  4 Unknown - Wild Animal                 416.               333            324. 
##  5 Unknown - Heavy Livesto…              374.               260            263. 
##  6 Fox                                   373.               328            206. 
##  7 Snake                                 356.               339            105. 
##  8 Dog                                   347.               298            169. 
##  9 Bird                                  344.               328            135. 
## 10 Cat                                   343.               298            160. 
## 11 Unknown - Domestic Anim…              326.               295            117. 
## 12 cat                                   324.               290             94.1
## 13 Hamster                               315.               290             95.0
## 14 Squirrel                              313.               326             57.1
## 15 Ferret                                309.               333             39.4
## 16 Rabbit                                309.               326             32.2
## # … with 3 more variables: min_incident_cost &lt;dbl&gt;, max_incident_cost &lt;dbl&gt;,
## #   count &lt;int&gt;</code></pre>
<pre class="r"><code>animal_rescue %&gt;%
  group_by(animal_group_parent) %&gt;%
  filter(n()&gt;6) %&gt;%

  # summarise() will collapse all values into 3 values: the mean, median, and count
  # we use na.rm=TRUE to make sure we remove any NAs, or cases where we do not have the incident cos
  summarise(mean_incident_cost = mean (incident_notional_cost, na.rm=TRUE),
            median_incident_cost = median (incident_notional_cost, na.rm=TRUE),
            mean_median_diff = mean_incident_cost - median_incident_cost) %&gt;%

  # sort the resulting data in descending order. You choose whether to sort by count or mean cost.
  arrange(-mean_median_diff)</code></pre>
<pre><code>## # A tibble: 16 × 4
##    animal_group_parent      mean_incident_co… median_incident_… mean_median_diff
##    &lt;chr&gt;                                &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
##  1 Horse                                 740.               596            144. 
##  2 Unknown - Heavy Livesto…              374.               260            114. 
##  3 Cow                                   634.               520            114. 
##  4 Deer                                  417.               333             83.9
##  5 Unknown - Wild Animal                 416.               333             83.3
##  6 Dog                                   347.               298             48.6
##  7 Cat                                   343.               298             44.9
##  8 Fox                                   373.               328             44.6
##  9 cat                                   324.               290             33.8
## 10 Unknown - Domestic Anim…              326.               295             30.5
## 11 Hamster                               315.               290             24.6
## 12 Snake                                 356.               339             16.9
## 13 Bird                                  344.               328             15.7
## 14 Squirrel                              313.               326            -13.4
## 15 Rabbit                                309.               326            -17.2
## 16 Ferret                                309.               333            -24.1</code></pre>
<pre class="r"><code>plot &lt;- animal_rescue %&gt;%
  filter(n()&gt;6) %&gt;%
  ggplot(aes(x=animal_group_parent, y=incident_notional_cost))

plot + geom_boxplot()</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/stats_on_incident_cost_box-1.png" width="672" /></p>
<blockquote>
<p>We can see that the diffrence between the mean and the median is du to numerous outliers that impact the mean far more than the median.</p>
</blockquote>
<p>Finally, let us plot a few plots that show the distribution of incident_cost for each animal group.</p>
<pre class="r"><code># base_plot
base_plot &lt;- animal_rescue %&gt;%
  group_by(animal_group_parent) %&gt;%
  filter(n()&gt;6) %&gt;%
  ggplot(aes(x=incident_notional_cost))+
  facet_wrap(~animal_group_parent, scales = &quot;free&quot;)+
  theme_bw()

base_plot + geom_histogram()</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/plots_on_incident_cost_by_animal_group-1.png" width="672" /></p>
<pre class="r"><code>base_plot + geom_density()</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/plots_on_incident_cost_by_animal_group-2.png" width="672" /></p>
<pre class="r"><code>base_plot + geom_boxplot()</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/plots_on_incident_cost_by_animal_group-3.png" width="672" /></p>
<pre class="r"><code>base_plot + stat_ecdf(geom = &quot;step&quot;, pad = FALSE) +
  scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="/blogs/Francois_Mizrahi_files/figure-html/plots_on_incident_cost_by_animal_group-4.png" width="672" /></p>
<blockquote>
<p>The best graph to communicate the variability is the density plot, as it offers the best general vision of the cost of each animal parent group. The most expensive animal groups to rescue are the Horses, Cows and Deers. This is not surprising as it is logical that larger animals are more expensive to save. The differences in pattern could be explained by the range of different types of rescues possible for the animal and its living habitat.</p>
</blockquote>
</div>
